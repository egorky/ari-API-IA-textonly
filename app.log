/app/app/services/ai_service.py:6: LangChainDeprecationWarning: Importing RedisChatMessageHistory from langchain.memory is deprecated. Please replace deprecated imports:

>> from langchain.memory import RedisChatMessageHistory

with new imports of:

>> from langchain_community.chat_message_histories import RedisChatMessageHistory
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/docs/versions/v0_2/>
  from langchain.memory import RedisChatMessageHistory, ConversationBufferMemory
/app/app/main.py:14: DeprecationWarning:
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).

  @app.on_event("startup")
INFO:     Started server process [9226]
INFO:     Waiting for application startup.
INFO:__main__:Application startup: Initializing ARI connection...
INFO:app.api.ari_handler:Creating new ARI client task.
INFO:__main__:ARI connection listener started.
INFO:app.api.ari_handler:Attempting ARI connection: http://localhost:8088, App: ai_ari_app
INFO:app.vendor.swaggerpy.http_client:Vendored SynchronousHttpClient initialized.
INFO:app.vendor.swaggerpy.http_client:Basic auth set for vendored SynchronousHttpClient (host: localhost - not used by this simplified client).
ERROR:app.vendor.swaggerpy.http_client:Error during request by vendored SyncHttpClient to http://localhost:8088/ari/api-docs/resources.json: HTTPConnectionPool(host='localhost', port=8088): Max retries exceeded with url: /ari/api-docs/resources.json (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f66f070a260>: Failed to establish a new connection: [Errno 111] Connection refused'))
ERROR:app.vendor.swaggerpy.client:Failed to load API docs from http://localhost:8088/ari/api-docs/resources.json: HTTPConnectionPool(host='localhost', port=8088): Max retries exceeded with url: /ari/api-docs/resources.json (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f66f070a260>: Failed to establish a new connection: [Errno 111] Connection refused'))
ERROR:app.api.ari_handler:Unexpected ARI client error: Could not load Swagger API specification from http://localhost:8088/ari/api-docs/resources.json
Traceback (most recent call last):
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f66f070a260>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8088): Max retries exceeded with url: /ari/api-docs/resources.json (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f66f070a260>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/app/vendor/swaggerpy/client.py", line 62, in __init__
    raw_api_docs = self.http_client.get(self.discovery_url).json() # This is a guess at SynchronousHttpClient API
  File "/app/app/vendor/swaggerpy/http_client.py", line 79, in get
    return self.request('GET', url, params=params, headers=headers, timeout=timeout)
  File "/app/app/vendor/swaggerpy/http_client.py", line 44, in request
    response = self.session.request(
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/swebot/.cache/pypoetry/virtualenvs/app-9TtSrW0h-py3.10/lib/python3.10/site-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8088): Max retries exceeded with url: /ari/api-docs/resources.json (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f66f070a260>: Failed to establish a new connection: [Errno 111] Connection refused'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/app/api/ari_handler.py", line 74, in _run_ari_client_with_retry
    client = ari.connect( # Removed await
  File "/app/app/vendor/ari_py/__init__.py", line 72, in connect
    return Client(swagger_spec_url, http_client=hc)
  File "/app/app/vendor/ari_py/client.py", line 36, in __init__
    self.swagger = swaggerpy_client_module.Client(
  File "/app/app/vendor/swaggerpy/client.py", line 74, in __init__
    raise RuntimeError(f"Could not load Swagger API specification from {self.discovery_url}") from e
RuntimeError: Could not load Swagger API specification from http://localhost:8088/ari/api-docs/resources.json
INFO:app.api.ari_handler:Attempting to reconnect ARI client in 10 seconds...
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [9226]
